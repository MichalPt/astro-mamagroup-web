---
import { getCollection } from "astro:content";
import CoursesLayout from "@/layouts/Courses.astro";
import type { CollectionEntry } from "astro:content";
import { slugify } from "@/utils/strings.ts"

const collectionName = "coursesMancal";
const rootPath = "/mancal/teaching/";

export async function getStaticPaths() {
    const courses = await getCollection("coursesMancal");
    return courses.map((course) => ({
        params: {
            course: course.id,
        },
        props: {
            course,
        },
    }));
}

const { course } = Astro.props;

const meta = {
    title: course.data.courseName,
    description: course.data.courseDescription || "",
};
---

<CoursesLayout meta={meta} collectionName={collectionName}>
    <h1 class="title mb-6">{course.data.courseName}</h1>
    <p>{course.data.courseDescription}</p>
    
    <div class="mt-8">
        <p class="text-xl title">Course Content:</p>
        {course.data.content.map((section) => (
            <div class="mb-6">
                <h3 class="text-lg font-semibold">{section.sectionTitle}</h3>
                {section.sectionContent.map((subsection) => (
                    <div class="ml-4 mb-4">
                        <h4 class="font-medium">{subsection.subsectionTitle}</h4>
                        <ul class="ml-4 list-decimal">
                            {subsection.subsectionContent.map((video) => (
                                <li>
                                    <a href={`${rootPath}${course.id}/${slugify(video.title)}`}>
                                        {video.title}
                                    </a>
                                </li>
                            ))}
                        </ul>
                    </div>
                ))}
            </div>
        ))}
    </div>
</CoursesLayout>